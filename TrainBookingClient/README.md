# 火车票预订系统 Qt客户端

## 概述

这是一个使用Qt6开发的现代化火车票预订系统桌面客户端，提供友好的图形用户界面，支持车次搜索、车票预订和订单查询功能。

## 功能特性

### 🔍 **车次搜索**
- 输入乘客信息（姓名、身份证号）
- 选择出发站、到达站和出发日期
- 实时显示可预订车次
- 显示座位类型、价格和余票信息

### 🎫 **车票预订**
- 选择车次和座位类型
- 确认预订信息
- 自动座位分配
- 显示预订结果和订单详情

### 📋 **订单查询**
- 按乘客信息查询个人订单
- 查询所有订单
- 显示订单状态和详细信息
- 实时更新订单状态

### 🎨 **界面特性**
- 现代化Material Design风格界面
- 响应式布局设计
- 实时状态提示
- 加载进度显示
- 错误提示和成功确认

## 技术栈

- **Qt6** - 跨平台GUI框架
- **C++17** - 现代C++标准
- **CMake** - 构建系统
- **QNetworkAccessManager** - HTTP网络通信
- **QJson** - JSON数据处理

## 系统要求

### 运行环境
- Windows 10/11 (64位)
- 或 Linux (Ubuntu 20.04+)
- 或 macOS (10.15+)

### 开发环境
- Qt6.2+ (包含Widgets和Network模块)
- CMake 3.16+
- C++17兼容的编译器 (MSVC 2019+, GCC 9+, Clang 10+)

## 安装和构建

### Windows

1. **安装Qt6**
   - 下载Qt6安装程序：https://www.qt.io/download
   - 安装时选择Qt6.2+版本，确保包含以下组件：
     - Qt6 Widgets
     - Qt6 Network
     - MinGW或MSVC编译器

2. **安装CMake**
   - 下载并安装CMake：https://cmake.org/download/
   - 确保CMake添加到系统PATH中

3. **设置环境变量**
   ```batch
   set PATH=%PATH%;C:\Qt\6.x.x\mingw_64\bin
   set CMAKE_PREFIX_PATH=C:\Qt\6.x.x\mingw_64
   ```

4. **构建项目**
   ```batch
   cd TrainBookingClient
   build.bat
   ```

### Linux/macOS

1. **安装Qt6**
   ```bash
   # Ubuntu/Debian
   sudo apt-get install qt6-base-dev qt6-base-dev-tools libqt6network6-dev
   
   # macOS (使用Homebrew)
   brew install qt6
   ```

2. **构建项目**
   ```bash
   cd TrainBookingClient
   mkdir build && cd build
   cmake ..
   make -j4
   ```

## 使用方法

### 1. 启动后端服务
在运行Qt客户端之前，确保后端服务正在运行：
```bash
cd ..  # 返回项目根目录
node back-end.js
```

### 2. 运行Qt客户端
```bash
# Windows
build\bin\TrainBookingClient.exe

# Linux/macOS
./build/TrainBookingClient
```

### 3. 使用流程

1. **搜索车次**
   - 填写乘客姓名和身份证号
   - 选择出发站和到达站
   - 选择出发日期
   - 点击"搜索车次"

2. **预订车票**
   - 在搜索结果中选择想要的车次和座位类型
   - 点击"预订选中车票"
   - 确认预订信息
   - 查看预订结果

3. **查询订单**
   - 输入乘客信息查询个人订单
   - 或点击"查询所有订单"查看全部订单
   - 查看订单状态和详细信息

## 界面截图

### 主界面
```
┌─────────────────────────────────────────────────────────┐
│ 🚄 火车票预订系统 - Qt客户端                             │
├─────────────────────────────────────────────────────────┤
│ 🔍 车次搜索                                              │
│ ┌─────────────┬─────────────┬─────────────┬─────────────┐ │
│ │ 乘客姓名     │ 身份证号     │ 出发站       │ 到达站       │ │
│ └─────────────┴─────────────┴─────────────┴─────────────┘ │
│ ┌─────────────┐ [🔍 搜索车次]                             │
│ │ 出发日期     │                                          │
│ └─────────────┘                                          │
├─────────────────────────────────────────────────────────┤
│ 🚄 可预订车次                                            │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 车次 │ 出发站 │ 到达站 │ 日期 │ 座位类型 │ 价格 │ 余票 │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │ G101 │ 北京   │ 上海   │...  │ 二等座   │ ¥553│ 197 │ │
│ └─────────────────────────────────────────────────────┘ │
│ [🎫 预订选中车票]                                         │
├─────────────────────────────────────────────────────────┤
│ 📋 订单查询                                              │
│ ┌─────────────┬─────────────┐ [📋 查询我的订单] [查询所有] │
│ │ 乘客姓名     │ 身份证号     │                             │
│ └─────────────┴─────────────┘                             │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 订单号 │ 车次 │ 日期 │ 行程 │ 座位 │ 乘客 │ 价格 │ 状态 │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

## 项目结构

```
TrainBookingClient/
├── main.cpp              # 应用程序入口
├── MainWindow.h           # 主窗口头文件
├── MainWindow.cpp         # 主窗口实现
├── CMakeLists.txt         # CMake构建配置
├── build.bat              # Windows构建脚本
├── README.md              # 项目说明文档
└── build/                 # 构建输出目录
    └── bin/
        └── TrainBookingClient.exe
```

## API集成

客户端通过HTTP REST API与后端服务通信：

- `POST /search-bookable-trains` - 搜索可预订车次
- `POST /book` - 预订车票
- `GET /orders` - 查询订单

详细API文档请参考根目录下的 `API_DOCUMENTATION.md`。

## 故障排除

### 常见问题

1. **编译错误：找不到Qt6**
   - 确保Qt6已正确安装
   - 检查环境变量PATH是否包含Qt的bin目录
   - 设置CMAKE_PREFIX_PATH指向Qt安装目录

2. **运行时错误：连接后端失败**
   - 确保后端服务已启动（运行 `node back-end.js`）
   - 检查API地址是否正确（默认 http://localhost:3000）
   - 确认防火墙设置

3. **界面显示异常**
   - 确保Qt6 Widgets模块已安装
   - 检查系统显示缩放设置
   - 尝试以管理员权限运行

### 调试模式

启用调试模式获取更多信息：
```bash
# 设置环境变量
set QT_LOGGING_RULES=*.debug=true

# 运行程序
TrainBookingClient.exe
```

## 开发说明

### 添加新功能

1. 在 `MainWindow.h` 中声明新的槽函数
2. 在 `MainWindow.cpp` 中实现功能
3. 更新UI布局（如需要）
4. 添加相应的信号连接

### 代码风格

- 使用Qt命名约定（camelCase）
- 私有成员变量使用 `m_` 前缀
- 常量使用全大写和下划线
- 适当添加注释说明

## 版本历史

- **v1.0.0** (2025-01-18)
  - 初始版本发布
  - 基本的搜索、预订、查询功能
  - 现代化UI设计
  - 完整的错误处理

## 许可证

本项目仅供学习和演示使用。

## 联系方式

如有问题或建议，请在项目仓库中创建Issue。 